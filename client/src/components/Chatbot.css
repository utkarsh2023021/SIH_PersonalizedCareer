/* ===== Design Tokens: themes + mode (WCAG AA aimed) ===== */
/* Spacing uses 8pt increments: 8, 16, 24, 32, 40, 48 for rhythm */
:root {
  --radius-sm: 8px;
  --radius-md: 14px;
  --radius-lg: 20px;

  --space-1: 8px;
  --space-2: 12px;
  --space-3: 16px;
  --space-4: 20px;
  --space-5: 24px;
  --space-6: 32px;

  --shadow-sm: 0 1px 4px rgba(0,0,0,.08);
  --shadow-md: 0 6px 18px rgba(0,0,0,.10);

  /* Grays (neutral) */
  --gray-50: #f7f8fa;
  --gray-100: #eef0f3;
  --gray-200: #e1e4ea;
  --gray-300: #cfd5df;
  --gray-400: #a9b2c0;
  --gray-500: #8792a6;
  --gray-600: #6a7487;
  --gray-700: #4e5668;
  --gray-800: #2c3342;
  --gray-900: #171b23;
}

/* Theme palettes: tuned for contrast in light/dark per WCAG AA */
:root[data-theme="aurora"][data-mode="light"] {
  --primary-500: #6f7bf7;   /* Indigo */
  --accent-500:  #ff7a59;   /* Coral */
  --bg: #ffffff;
  --surface: #ffffff;
  --surface-2: #f8f9fb;
  --text: var(--gray-800);
  --text-inverse: #ffffff;
  --border: var(--gray-200);
}
:root[data-theme="aurora"][data-mode="dark"] {
  --primary-500: #8ea0ff;
  --accent-500:  #ff9b7f;
  --bg: #0f1320;
  --surface: #151a2a;
  --surface-2: #0f1320;
  --text: #e9edf7;
  --text-inverse: #0f1320;
  --border: #2a3145;
}

:root[data-theme="ocean"][data-mode="light"] {
  --primary-500: #0ea5e9;   /* Sky */
  --accent-500:  #22c55e;   /* Green */
  --bg: #ffffff;
  --surface: #ffffff;
  --surface-2: #f5fbff;
  --text: var(--gray-800);
  --text-inverse: #ffffff;
  --border: #d9eef9;
}
:root[data-theme="ocean"][data-mode="dark"] {
  --primary-500: #38bdf8;
  --accent-500:  #34d399;
  --bg: #06131a;
  --surface: #0b1a22;
  --surface-2: #06131a;
  --text: #e6fbff;
  --text-inverse: #06131a;
  --border: #15323f;
}

:root[data-theme="orchid"][data-mode="light"] {
  --primary-500: #a855f7;   /* Purple */
  --accent-500:  #f59e0b;   /* Amber */
  --bg: #ffffff;
  --surface: #ffffff;
  --surface-2: #fbf7ff;
  --text: var(--gray-800);
  --text-inverse: #ffffff;
  --border: #eadff8;
}
:root[data-theme="orchid"][data-mode="dark"] {
  --primary-500: #c084fc;
  --accent-500:  #fbbf24;
  --bg: #180e22;
  --surface: #22142c;
  --surface-2: #180e22;
  --text: #f7ecff;
  --text-inverse: #180e22;
  --border: #3b2847;
}

/* ===== Container & Header ===== */
.chatbot-container {
  max-width: 1000px;
  margin: 40px auto;
  padding: 0 20px;
  height: calc(100vh - 160px);
  display: flex;
  flex-direction: column;
  background: var(--bg);
  color: var(--text);
}

.chatbot-header {
  text-align: center;
  margin-bottom: 32px;
}

.chatbot-header h2 {
  color: var(--text);
  font-size: 2rem;
  margin-bottom: 8px;
}

.chatbot-header p {
  color: var(--gray-600);
  font-size: 1.05rem;
  margin: 0;
}

/* Theme toolbar */
.toolbar {
  margin-top: 16px;
  display: flex;
  gap: 12px;
  justify-content: center;
  flex-wrap: wrap;
}
.segmented {
  background: var(--surface-2);
  border: 1px solid var(--border);
  border-radius: 999px;
  padding: 4px;
  display: inline-flex;
  gap: 4px;
  box-shadow: var(--shadow-sm);
}
.segmented button {
  border: 0;
  background: transparent;
  color: var(--text);
  padding: 8px 12px;
  border-radius: 999px;
  cursor: pointer;
  font-size: 0.9rem;
}
.segmented button.active {
  background: linear-gradient(135deg, var(--primary-500), var(--accent-500));
  color: var(--text-inverse);
  box-shadow: 0 6px 14px rgba(0,0,0,.15);
}

/* ===== Messages ===== */
.chatbot-messages {
  flex: 1;
  overflow-y: auto;
  padding: 20px;
  background: var(--surface-2);
  border-radius: 20px;
  margin-bottom: 20px;
  display: flex;
  flex-direction: column;
  gap: 16px;
  box-shadow:
    6px 6px 18px rgba(0, 0, 0, 0.08),
    -6px -6px 18px rgba(255, 255, 255, 0.7);
}

/* Scrollbar */
.chatbot-messages::-webkit-scrollbar { width: 10px; }
.chatbot-messages::-webkit-scrollbar-track { background: transparent; border-radius: 999px; }
.chatbot-messages::-webkit-scrollbar-thumb {
  background: linear-gradient(180deg, var(--primary-500), var(--accent-500));
  border-radius: 999px;
}
.chatbot-messages::-webkit-scrollbar-thumb:hover {
  filter: brightness(1.1);
}

/* Day divider and subtle separators for readability */
.day-group { display: flex; flex-direction: column; gap: 12px; }
.day-divider {
  display: grid;
  place-items: center;
  position: relative;
  margin: 8px 0 4px;
}
.day-divider::before {
  content: "";
  height: 1px;
  background: var(--border);
  position: absolute;
  left: 0; right: 0;
}
.day-divider span {
  background: var(--surface-2);
  padding: 4px 10px;
  border: 1px solid var(--border);
  border-radius: 999px;
  color: var(--gray-600);
  font-size: 0.75rem;
  position: relative;
}

/* Message rows with adjacency compaction */
.message { display: flex; max-width: 80%; gap: 12px; }
.message.user { align-self: flex-end; }
.message.bot { align-self: flex-start; }
.message.adjacent .avatar { visibility: hidden; }
.message.adjacent .message-content { margin-top: -6px; }

/* Avatars */
.message .avatar {
  width: 36px; height: 36px;
  border-radius: 50%;
  overflow: hidden;
  margin: 0 4px;
  flex-shrink: 0;
  box-shadow: var(--shadow-sm);
  display: grid; place-items: center;
  background: var(--surface);
}

/* Bubbles: geometry refined, AA contrast on text */
.message-content {
  padding: 16px 20px;
  border-radius: 18px;
  position: relative;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.10);
  line-height: 1.5;
  font-size: 0.975rem;
  word-break: break-word;
  border: 1px solid var(--border);
}

/* User bubble */
.message.user .message-content {
  background: linear-gradient(135deg, var(--primary-500), var(--accent-500));
  color: var(--text-inverse);
  border-color: transparent;
  border-bottom-right-radius: 8px;
}

/* Bot bubble */
.message.bot .message-content {
  background: var(--surface);
  color: var(--text);
  border-bottom-left-radius: 8px;
}

/* Tails */
.message.user .message-content::after,
.message.bot .message-content::after {
  content: "";
  position: absolute;
  bottom: 10px;
  width: 12px; height: 12px;
  transform: rotate(45deg);
  box-shadow: 0 1px 6px rgba(0, 0, 0, 0.08);
}
.message.user .message-content::after {
  right: -3px;
  background: linear-gradient(135deg, var(--primary-500), var(--accent-500));
  border-bottom-right-radius: 2px;
}
.message.bot .message-content::after {
  left: -3px;
  background: var(--surface);
  border-bottom-left-radius: 2px;
}

/* Lists inside bot replies: clearer separation */
.formatted-list { margin: 0; padding: 0 0 0 20px; }
.formatted-list-item {
  margin: 4px 0;
  list-style-type: disc;
  color: inherit;
  padding-left: 2px;
}

/* Metadata, links, code blocks */
.message-meta { display: flex; gap: 8px; align-items: center; margin-bottom: 6px; color: var(--gray-500); font-size: 0.8rem; }
.message-time { color: var(--gray-500); font-size: 0.75rem; }
.message.bot .message-content pre,
.message.bot .message-content code {
  background: var(--surface-2);
  border-radius: 10px;
  padding: 10px 12px;
  display: block;
  overflow-x: auto;
}
.message-content a { color: var(--primary-500); text-decoration: underline; text-underline-offset: 2px; }
.message.user .message-content a { color: #fff; text-decoration-color: rgba(255,255,255,.7); }

/* Empty state */
.chatbot-empty {
  height: 100%;
  display: grid;
  place-items: center;
  color: var(--gray-500);
  text-align: center;
  padding: 28px;
}
.empty-icon { font-size: 28px; margin-bottom: 8px; }

/* Loading indicator */
.chatbot-loading { display: inline-flex; gap: 6px; align-items: center; color: var(--gray-500); font-size: 0.9rem; }
.chatbot-loading .dot { width: 6px; height: 6px; background: var(--gray-400); border-radius: 50%; animation: blink 1.2s infinite ease-in-out; }
.chatbot-loading .dot:nth-child(2) { animation-delay: 0.2s; }
.chatbot-loading .dot:nth-child(3) { animation-delay: 0.4s; }
@keyframes blink { 0%,80%,100%{opacity:.2;} 40%{opacity:1;} }

/* Input area */
.chatbot-input {
  display: grid;
  grid-template-columns: 1fr auto;
  gap: 12px;
  align-items: center;
}
.chatbot-textarea {
  width: 100%;
  min-height: 48px;
  max-height: 144px;
  resize: vertical;
  padding: 12px 14px;
  background: var(--surface);
  color: var(--text);
  border: 1px solid var(--border);
  border-radius: 14px;
  outline: none;
  transition: border-color .2s ease, box-shadow .2s ease;
  box-shadow: inset 0 1px 2px rgba(0,0,0,.04), 3px 3px 12px rgba(0,0,0,.04), -3px -3px 12px rgba(255,255,255,.8);
}
.chatbot-textarea:focus {
  border-color: var(--primary-500);
  box-shadow: 0 0 0 3px color-mix(in srgb, var(--primary-500) 20%, transparent);
}

.chatbot-send {
  height: 48px;
  padding: 0 18px;
  border: none;
  border-radius: 14px;
  color: var(--text-inverse);
  cursor: pointer;
  background: linear-gradient(135deg, var(--primary-500), var(--accent-500));
  box-shadow: 0 8px 16px rgba(0,0,0,.20);
  transition: transform .06s ease, box-shadow .2s ease, opacity .2s ease;
  justify-self: end;
}
.chatbot-send:hover { box-shadow: 0 10px 18px rgba(0,0,0,.24); }
.chatbot-send:active { transform: translateY(1px); }

/* Helper chips retained */
.helper-chip {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  border-radius: 999px;
  background: var(--surface);
  color: var(--gray-700);
  border: 1px solid var(--border);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
  font-size: 0.85rem;
}

/* Responsive */
@media (max-width: 768px) {
  .chatbot-container { padding: 0 12px; height: calc(100vh - 120px); }
  .message { max-width: 88%; }
}
@media (max-width: 480px) {
  .chatbot-container { margin: 20px auto; height: calc(100vh - 100px); }
  .chatbot-header h2 { font-size: 1.6rem; }
  .chatbot-header p { font-size: 1rem; }
  .message { max-width: 92%; }
}
